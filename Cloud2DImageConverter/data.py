# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/00_data.ipynb.

# %% auto 0
__all__ = ['folder_path', 'label_map', 'learning_map', 'color_map', 'load_data']

# %% ../nbs/00_data.ipynb 3
import numpy as np
import yaml
import os

# %% ../nbs/00_data.ipynb 5
folder_path = "../point_clouds/semantic_kitti/"

with open(folder_path+"semantic-kitti.yaml", 'r') as file:
    data = yaml.safe_load(file)

label_map = data.get('labels', {})
learning_map = data.get('learning_map', {})
color_map = data.get('color_map', {})

# %% ../nbs/00_data.ipynb 7
def load_data(velodyne_path, labels_path, velodyne_list, label_list):
    #import pdb
    point_cloud = []
    for index in (range(len(velodyne_list))):
        #pdb.set_trace()
        frame_path = os.path.join(velodyne_path, velodyne_list[index])
        with open(frame_path, 'rb') as f:
            frame = np.fromfile(f, dtype=np.float32).reshape(-1, 4)

        label_path = os.path.join(labels_path, label_list[index])
        with open(label_path, 'rb') as f:
            label = np.fromfile(f, dtype=np.uint32)
            label = label & 0xFFFF
            
        point_cloud.append(np.concatenate((frame, label.reshape(-1, 1)), axis=1))
        
    return point_cloud
